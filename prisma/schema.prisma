generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/client"
}

datasource db {
  provider = "mysql"
}

model Account {
  id             String   @id @default(cuid())
  accnt_no       Int      @unique
  accnt_type_no  Int      @default(1)
  name           String
  balance        Float?   @default(0)
  type           String
  header         String
  bank           String
  category       String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@map("chart_of_account")
}

model Transaction {
  id                 String    @id @default(cuid())
  seq                Int?
  ledger             String?
  transNo            String?
  code               String?
  accountNumber      String?
  date               DateTime?
  invoiceNumber      String?
  particulars        String?
  debit              Float?    @default(0)
  credit             Float?    @default(0)
  balance            Float?    @default(0)
  checkAccountNumber String?
  checkNumber        String?
  dateMatured        DateTime?
  accountName        String?
  bankName           String?
  bankBranch         String?
  user               String?
  isCoincide         Boolean?
  dailyClosing       Int?
  approval           String?
  ftToLedger         String?
  ftToAccount        String?
  ssma_timestamp     DateTime?
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt

  @@map("transactions")
}

model LoyaltyPointSetting {
  id              String   @id @default(cuid())
  description     String
  amount          Float    @default(0)
  equivalentPoint Float    @default(0)
  loyaltyPoints   LoyaltyPoint[]
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@map("loyalty_point_setting")
}

model Customer {
  id                        String   @id @default(cuid())
  code                      String   @unique
  customerName              String
  contactFirstName          String?
  address                   String?
  phonePrimary              String?
  phoneAlternative          String?
  email                     String?
  isActive                  Boolean  @default(true)
  creditLimit               Float?   @default(0)
  isTaxExempt               Boolean  @default(false)
  paymentTerms              String?  @default("days")
  paymentTermsValue         String?  @default("30")
  salesperson                String?
  customerGroup             String?  @default("default")
  isEntitledToLoyaltyPoints Boolean  @default(false)
  pointSetting              String?
  loyaltyCalculationMethod  String?  @default("automatic")
  loyaltyCardNumber         String?
  loyaltyPoints             LoyaltyPoint[]
  createdAt                 DateTime @default(now())
  updatedAt                 DateTime @updatedAt

  @@map("customer")
}

model LoyaltyPoint {
  id              String   @id @default(cuid())
  customerId      String
  customer        Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
  loyaltyCardId   String
  totalPoints     Float    @default(0)
  pointSettingId  String
  pointSetting    LoyaltyPointSetting @relation(fields: [pointSettingId], references: [id])
  expiryDate      DateTime?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@map("loyalty_point")
}

model Product {
  id              String    @id @default(cuid())
  code            String    @unique
  name            String
  barcode         String?
  description     String?
  additionalDescription String?
  category        String?
  categoryId      String?
  subcategoryId   String?
  brandId         String?
  supplierId      String?
  unitOfMeasureId String?
  unitPrice       Float     @default(0)
  costPrice       Float     @default(0)
  stockQuantity   Int       @default(0)
  minStockLevel   Int       @default(0)
  maxStockLevel   Int?
  isActive        Boolean   @default(true)
  salesOrder      String?
  autoCreateChildren Boolean @default(false)
  initialStock    Int       @default(0)
  reorderPoint    Int       @default(0)
  incomeAccountId String?
  expenseAccountId String?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@map("product")
}

model ConversionFactor {
  id              String    @id @default(cuid())
  productId       String
  unitName        String
  factor          Float
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@map("conversion_factor")
}

model Brand {
  id              String    @id @default(cuid())
  name            String    @unique
  description     String?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@map("brand")
}

model Category {
  id              String    @id @default(cuid())
  name            String    @unique
  description     String?
  parentCategoryId String?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@map("category")
}

model Supplier {
  id              String    @id @default(cuid())
  name            String    @unique
  contactPerson   String?
  email           String?
  phone           String?
  address         String?
  paymentTerms    String?
  isActive        Boolean   @default(true)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@map("supplier")
}

model UnitOfMeasure {
  id              String    @id @default(cuid())
  code            String    @unique
  name            String    @unique
  description     String?
  isActive        Boolean   @default(true)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  @@map("unit_of_measure")
}

model Reminder {
  id          String   @id @default(cuid())
  title       String
  memo        String?
  date        DateTime
  endDate     DateTime?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("reminder")
}

model SalesUser {
  id          String   @id @default(cuid())
  name        String
  uniqueId    String   @unique
  username    String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("sales_user")
}

model UserPermission {
  id           String   @id @default(cuid())
  username     String   @unique
  firstName    String
  middleName   String?
  lastName     String
  designation  String
  userAccess   String
  contactNo    String?
  accountType  String
  password     String?
  permissions  String   @db.Text // JSON string containing permissions
  isActive     Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@map("user_permission")
}

model BusinessProfile {
  id           String   @id @default(cuid())
  businessName String
  address      String?
  owner        String?
  contactPhone String?
  contactTel   String?
  email        String?
  tin          String?
  permit       String?
  logo         String?  @db.LongText
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@map("business_profile")
}

model BackupSchedule {
  id          String   @id @default(cuid())
  backupTime  DateTime
  frequency   String   // "week", "month", "custom"
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("backup_schedule")
}
