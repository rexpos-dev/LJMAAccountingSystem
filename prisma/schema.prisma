generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model Account {
  id                  String   @id @default(cuid())
  account_no          Int      @unique
  account_name        String
  balance             Float?   @default(0)
  account_type        String
  header              String
  bank                String
  account_category    String?
  date_created        DateTime @default(now())
  last_updated_at     DateTime @updatedAt
  account_type_no     Int      @default(1)
  account_description String?
  fs_category         String?
  account_status      String   @default("Active")

  @@map("chart_of_account")
}

model Transaction {
  id                 String    @id @default(cuid())
  seq                Int?
  ledger             String?
  transNo            String?
  code               String?
  accountNumber      String?
  date               DateTime?
  invoiceNumber      String?
  particulars        String?
  debit              Float?    @default(0)
  credit             Float?    @default(0)
  balance            Float?    @default(0)
  checkAccountNumber String?
  checkNumber        String?
  dateMatured        DateTime?
  accountName        String?
  bankName           String?
  bankBranch         String?
  user               String?
  isCoincide         Boolean?
  dailyClosing       Int?
  approval           String?
  ftToLedger         String?
  ftToAccount        String?
  ssma_timestamp     DateTime?
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt

  @@map("transactions")
}

model LoyaltyPointSetting {
  id              String         @id @default(cuid())
  description     String
  amount          Float          @default(0)
  equivalentPoint Float          @default(0)
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  loyaltyPoints   LoyaltyPoint[]

  @@map("loyalty_point_setting")
}

model Customer {
  id                        String         @id @default(cuid())
  code                      String         @unique
  customerName              String
  contactFirstName          String?
  address                   String?
  phonePrimary              String?
  phoneAlternative          String?
  email                     String?
  isActive                  Boolean        @default(true)
  creditLimit               Float?         @default(0)
  isTaxExempt               Boolean        @default(false)
  paymentTerms              String?        @default("days")
  paymentTermsValue         String?        @default("30")
  salesperson               String?
  customerGroup             String?        @default("default")
  isEntitledToLoyaltyPoints Boolean        @default(false)
  pointSetting              String?
  loyaltyCalculationMethod  String?        @default("automatic")
  loyaltyCardNumber         String?
  createdAt                 DateTime       @default(now())
  updatedAt                 DateTime       @updatedAt
  invoices                  Invoice[]
  loyaltyPoints             LoyaltyPoint[]

  @@map("customer")
}

model LoyaltyPoint {
  id             String              @id @default(cuid())
  customerId     String
  loyaltyCardId  String
  totalPoints    Float               @default(0)
  pointSettingId String
  expiryDate     DateTime?
  createdAt      DateTime            @default(now())
  updatedAt      DateTime            @updatedAt
  customer       Customer            @relation(fields: [customerId], references: [id], onDelete: Cascade)
  pointSetting   LoyaltyPointSetting @relation(fields: [pointSettingId], references: [id])

  @@index([customerId], map: "loyalty_point_customerId_fkey")
  @@index([pointSettingId], map: "loyalty_point_pointSettingId_fkey")
  @@map("loyalty_point")
}

model Product {
  id                    String                 @id @default(cuid())
  code                  String                 @unique
  name                  String
  barcode               String?
  description           String?
  additionalDescription String?
  category              String?
  categoryId            String?
  subcategoryId         String?
  brandId               String?
  supplierId            String?
  unitOfMeasureId       String?
  unitPrice             Float                  @default(0)
  costPrice             Float                  @default(0)
  stockQuantity         Int                    @default(0)
  minStockLevel         Int                    @default(0)
  maxStockLevel         Int?
  isActive              Boolean                @default(true)
  salesOrder            String?
  autoCreateChildren    Boolean                @default(false)
  initialStock          Int                    @default(0)
  reorderPoint          Int                    @default(0)
  incomeAccountId       String?
  expenseAccountId      String?
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt
  inventoryTransactions InventoryTransaction[]
  invoiceItems          InvoiceItem[]
  history               ProductHistory[]
  purchaseOrderItems    PurchaseOrderItem[]
  requestItems          RequestItem[]

  @@map("product")
}

model ConversionFactor {
  id        String   @id @default(cuid())
  productId String
  unitName  String
  factor    Float
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("conversion_factor")
}

model Brand {
  id          String   @id @default(cuid())
  name        String   @unique
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("brand")
}

model Category {
  id               String   @id @default(cuid())
  name             String   @unique
  description      String?
  parentCategoryId String?
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  @@map("category")
}

model Supplier {
  id                String          @id @default(cuid())
  name              String          @unique
  contactPerson     String?
  email             String?
  phone             String?
  address           String?
  paymentTerms      String?
  isActive          Boolean         @default(true)
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  additionalInfo    String?
  contactFirstName  String?
  fax               String?
  isTaxExempt       Boolean         @default(false)
  paymentTermsValue String?
  phoneAlternative  String?
  vatInfo           String?
  purchaseOrders    PurchaseOrder[]

  @@map("supplier")
}

model UnitOfMeasure {
  id          String   @id @default(cuid())
  code        String   @unique
  name        String   @unique
  description String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("unit_of_measure")
}

model Reminder {
  id        String    @id @default(cuid())
  title     String
  memo      String?
  date      DateTime
  endDate   DateTime?
  isActive  Boolean   @default(true)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  isRead    Boolean   @default(false)

  @@map("reminder")
}

model SalesUser {
  id        String   @id @default(cuid())
  name      String
  uniqueId  String   @unique
  username  String?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("sales_user")
}

model UserPermission {
  id          String   @id @default(cuid())
  username    String   @unique
  firstName       String
  lastName        String
  designation     String?
  contactNo       String?
  accountType     String
  formPermissions String?
  permissions     String   @db.Text
  isActive        Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  password        String?

  @@map("user_permission")
}

model BusinessProfile {
  id           String   @id @default(cuid())
  businessName String
  address      String?
  owner        String?
  contactPhone String?
  contactTel   String?
  email        String?
  tin          String?
  permit       String?
  logo         String?  @db.LongText
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@map("business_profile")
}

model BackupSchedule {
  id         String   @id @default(cuid())
  backupTime DateTime
  frequency  String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@map("backup_schedule")
}

model Notification {
  id        String   @id @default(cuid())
  type      String
  title     String
  message   String?
  entityId  String?
  userId    String?
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())

  @@index([userId])
  @@map("notification")
}

model BackupJob {
  id          String    @id @default(cuid())
  status      String
  filePath    String?
  fileName    String?
  fileSize    String?
  createdBy   String?
  log         String?   @db.Text
  createdAt   DateTime  @default(now())
  completedAt DateTime?

  @@map("backup_job")
}

model PurchaseOrder {
  id              String              @id @default(cuid())
  supplierId      String
  date            DateTime
  vendorAddress   String?             @db.Text
  shippingAddress String?             @db.Text
  taxType         String?             @default("default")
  comments        String?             @db.Text
  privateComments String?             @db.Text
  subtotal        Float               @default(0)
  taxTotal        Float               @default(0)
  total           Float               @default(0)
  status          String              @default("Open")
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @updatedAt
  supplier        Supplier            @relation(fields: [supplierId], references: [id])
  items           PurchaseOrderItem[]

  @@index([supplierId], map: "purchase_order_supplierId_fkey")
  @@map("purchase_order")
}

model PurchaseOrderItem {
  id                String        @id @default(cuid())
  purchaseOrderId   String
  productId         String?
  itemDescription   String
  quantity          Int
  unitPrice         Float
  tax               Float?
  total             Float
  category          String?
  sku               String?
  barcode           String?
  buyingUom         String?
  qtyPerCase        Int?
  offtake           Int?
  orderQty          Int?
  pieces            Int?
  costPricePerCase  Float?
  costPricePerPiece Float?
  discount1         Float?
  discount2         Float?
  discount3         Float?
  netCostAmount     Float?
  createdAt         DateTime      @default(now())
  updatedAt         DateTime      @updatedAt
  product           Product?      @relation(fields: [productId], references: [id])
  purchaseOrder     PurchaseOrder @relation(fields: [purchaseOrderId], references: [id], onDelete: Cascade)

  @@index([productId], map: "purchase_order_item_productId_fkey")
  @@index([purchaseOrderId], map: "purchase_order_item_purchaseOrderId_fkey")
  @@map("purchase_order_item")
}

model Invoice {
  id               String        @id @default(cuid())
  invoiceNumber    String        @unique
  customerId       String
  customerPONumber String?
  date             DateTime
  dueDate          DateTime?
  terms            String?
  salesperson      String?
  depositAccount   String?
  billingAddress   String?       @db.Text
  shippingAddress  String?       @db.Text
  subtotal         Float         @default(0)
  total            Float         @default(0)
  status           String        @default("Pending")
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt
  customer         Customer      @relation(fields: [customerId], references: [id])
  items            InvoiceItem[]

  @@index([customerId], map: "invoice_customerId_fkey")
  @@map("invoice")
}

model InvoiceItem {
  id          String   @id @default(cuid())
  invoiceId   String
  productId   String?
  description String
  quantity    Float
  unitPrice   Float
  total       Float
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  invoice     Invoice  @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  product     Product? @relation(fields: [productId], references: [id])

  @@index([invoiceId], map: "invoice_item_invoiceId_fkey")
  @@index([productId], map: "invoice_item_productId_fkey")
  @@map("invoice_item")
}

model ProductHistory {
  id        String   @id @default(cuid())
  productId String
  field     String
  oldValue  String?
  newValue  String?
  changedBy String?
  changedAt DateTime @default(now())
  product   Product  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([productId], map: "product_history_productId_fkey")
  @@map("product_history")
}

model InventoryTransaction {
  id          String      @id @default(cuid())
  productId   String
  type        String
  quantity    Int
  referenceId String?
  status      String      @default("Pending")
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  product     Product     @relation(fields: [productId], references: [id])
  kanbanCard  KanbanCard?

  @@index([productId], map: "inventory_transaction_productId_fkey")
  @@map("inventory_transaction")
}

model KanbanBoard {
  id        String         @id @default(cuid())
  title     String
  type      String
  createdAt DateTime       @default(now())
  updatedAt DateTime       @updatedAt
  columns   KanbanColumn[]

  @@map("kanban_board")
}

model KanbanColumn {
  id        String       @id @default(cuid())
  boardId   String
  title     String
  order     Int
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt
  cards     KanbanCard[]
  board     KanbanBoard  @relation(fields: [boardId], references: [id], onDelete: Cascade)

  @@index([boardId], map: "kanban_column_boardId_fkey")
  @@map("kanban_column")
}

model KanbanCard {
  id            String                @id @default(cuid())
  columnId      String
  content       String?
  position      Int
  transactionId String?               @unique
  createdAt     DateTime              @default(now())
  updatedAt     DateTime              @updatedAt
  column        KanbanColumn          @relation(fields: [columnId], references: [id], onDelete: Cascade)
  transaction   InventoryTransaction? @relation(fields: [transactionId], references: [id])

  @@index([columnId], map: "kanban_card_columnId_fkey")
  @@map("kanban_card")
}

model Request {
  id            String        @id @default(cuid())
  requestNumber String        @unique
  requesterName String
  position      String?
  accountNo     String?
  businessUnit  String?
  department    String?
  purpose       String?
  chargeTo      String?
  amount        Float         @default(0)
  verifiedBy    String?
  approvedBy    String?
  processedBy   String?
  date          DateTime      @default(now())
  status        String        @default("To Verify")
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  formName      String?       @db.VarChar(255)
  items         RequestItem[]

  @@map("request")
}

model RequestItem {
  id          String   @id @default(cuid())
  requestId   String
  productId   String?
  description String
  quantity    Int
  unit        String?
  unitPrice   Float    @default(0)
  total       Float    @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  product     Product? @relation(fields: [productId], references: [id])
  request     Request  @relation(fields: [requestId], references: [id], onDelete: Cascade)

  @@index([productId], map: "request_item_productId_fkey")
  @@index([requestId], map: "request_item_requestId_fkey")
  @@map("request_item")
}
